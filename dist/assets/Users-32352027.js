import{j as e,w as ie,T as C,K as l,r as m,I,C as v,a3 as ce,N as $,a1 as U,a2 as k,F,a4 as de,a5 as ue,O as me,a6 as H,a7 as he,Q as pe,S as xe,R as _,E as ge,a8 as be,a9 as fe,M as P,W as je}from"./index-0fca6773.js";import{T as A,a as p,b as ye,c as Se,d as ve,e as Ce,u as R,f as Te,g as Ne,C as Ee}from"./user-bcbc9869.js";import{L as G}from"./label-6990dc07.js";import{e as we}from"./edit_icon-feef8411.js";const Pe={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function Re(a,c,x){return a?Math.max(0,(1+a)*c-x):0}function z({query:a}){return e.jsx(A,{children:e.jsx(p,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(ie,{sx:{textAlign:"center"},children:[e.jsx(C,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(C,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',a,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}z.propTypes={query:l.string};function K({selected:a,domain:c,role:x,mobileNumber:g,status:u,edit:b,email:T,publicId:j,concurrencyStamp:o}){const[f,S]=m.useState(null),O=h=>{S(h.currentTarget)},y=()=>{S(null)},N=h=>{console.log("check-ststua ",j,o);const E={status:h};console.log(E,"statusUpdateBody");const t=`${k.STATUS_UPDATE_CATEGORY}/${j}`;U.patch(t,E,{headers:{"x-coreplatform-concurrencyStamp":o}}).then(d=>{d.status===204?window.location.reload():console.error("Unexpected response:",d)}).catch(d=>{d.response&&(d.response.status===417?console.error("Error 417:",d):d.response.status===500&&console.error("Error 500:",d))})};return e.jsxs(e.Fragment,{children:[e.jsxs(A,{hover:!0,tabIndex:-1,role:"checkbox",selected:a,children:[e.jsx(p,{children:c}),e.jsx(p,{children:T}),e.jsx(p,{children:x}),e.jsx(p,{children:g}),e.jsx(p,{children:e.jsx(G,{color:u==="banned"&&"error"||"success",children:u})}),e.jsx(p,{children:e.jsx(G,{children:b})}),e.jsx(p,{align:"right",children:e.jsx(I,{onClick:O,children:e.jsx(v,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(ce,{open:!!f,anchorEl:f,onClose:y,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsx($,{onClick:()=>N("active"),children:"Active"}),e.jsx($,{onClick:()=>N("inactive"),sx:{color:"error.main"},children:"Inactive"})]})]})}K.propTypes={edit:l.any,publicId:l.any,concurrencyStamp:l.any,status:l.string,domain:l.string,mobileNumber:l.any,email:l.any,role:l.any,selected:l.any};function Q({order:a,orderBy:c,rowCount:x,headLabel:g,numSelected:u,onRequestSort:b,onSelectAllClick:T}){const j=o=>f=>{b(f,o)};return e.jsx(ye,{children:e.jsx(A,{children:g.map(o=>e.jsx(p,{align:o.align||"left",sortDirection:c===o.id?a:!1,sx:{width:o.width,minWidth:o.minWidth},children:e.jsxs(Se,{hideSortIcon:!0,active:c===o.id,direction:c===o.id?a:"asc",onClick:j(o.id),children:[o.label,c===o.id?e.jsx(F,{sx:{...Pe},children:a==="desc"?"sorted descending":"sorted ascending"}):null]})},o.id))})})}Q.propTypes={order:l.oneOf(["asc","desc"]),orderBy:l.string,rowCount:l.number,headLabel:l.array,numSelected:l.number,onRequestSort:l.func,onSelectAllClick:l.func};function V({emptyRows:a,height:c}){return a?e.jsx(A,{sx:{...c&&{height:c*a}},children:e.jsx(p,{colSpan:9})}):null}V.propTypes={emptyRows:l.number,height:l.number};function J({numSelected:a,filterName:c,onFilterName:x}){return e.jsxs(de,{sx:{height:96,display:"flex",justifyContent:"space-between",p:g=>g.spacing(0,1,0,3),...a>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[a>0?e.jsxs(C,{component:"div",variant:"subtitle1",children:[a," selected"]}):e.jsx(ue,{value:c,onChange:x,placeholder:"Search user...",startAdornment:e.jsx(me,{position:"start",children:e.jsx(v,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),a>0?e.jsx(H,{title:"Delete",children:e.jsx(I,{children:e.jsx(v,{icon:"eva:trash-2-fill"})})}):e.jsx(H,{title:"Filter list",children:e.jsx(I,{children:e.jsx(v,{icon:"ic:round-filter-list"})})})]})}J.propTypes={numSelected:l.number,filterName:l.string,onFilterName:l.func};function Ue(){const[a,c]=m.useState(0),[x,g]=m.useState("asc"),[u,b]=m.useState([]),[T,j]=m.useState([]),[o,f]=m.useState(!1),[S,O]=m.useState("name"),[y,N]=m.useState(""),[h,E]=m.useState(5),[t,d]=m.useState({name:"",email:"",role:"",mobileNumber:""}),[w,q]=m.useState({name:"",email:"",role:"",mobileNumber:""}),[B,M]=m.useState("");m.useEffect(()=>{(()=>{const n=`${k.GET_USERS}?pageSize=${h}&pageNumber=${a}`;U.get(n).then(r=>{console.log("get-all users",r),j(r.data)}).catch(r=>{console.error(r)})})()},[h,a]);const X=()=>{const s={};if(t.name||(s.name="name is required."),t.email||(s.email="email is required."),t.role||(s.role="role is required."),t.mobileNumber||(s.mobileNumber="mobileNumber is required."),Object.keys(s).length>0){q(s),M("");return}q({name:"",email:"",role:"",mobileNumber:""});const n=k.POST_USERS,r={name:t.name,email:t.email,role:t.role,mobileNumber:t.mobileNumber,status:"active"};console.log("req-category-body-",r),U.post(n,r).then(i=>{i.status==="201"?(M("users added successfully"),window.location.reload()):console.error("Unexpected response:",i)}).catch(i=>{i.response&&(i.response.status===417?console.error("Error 417:",i):i.response.status===500&&console.error("Error 500:",i))})},Z=(s,n)=>{n!==""&&(g(S===n&&x==="asc"?"desc":"asc"),O(n))},ee=s=>{if(s.target.checked){const n=R.map(r=>r.name);b(n);return}b([])},se=(s,n)=>{const r=u.indexOf(n);let i=[];r===-1?i=i.concat(u,n):r===0?i=i.concat(u.slice(1)):r===u.length-1?i=i.concat(u.slice(0,-1)):r>0&&(i=i.concat(u.slice(0,r),u.slice(r+1))),b(i)},te=(s,n)=>{c(n)},ne=s=>{c(0),E(parseInt(s.target.value,10))},re=s=>{c(0),N(s.target.value)},D=T.filter(s=>s.name.toLowerCase().includes(y.toLowerCase())),ae=!D.length&&!!y,[le,W]=he.useState(!1),L=s=>{console.log("row",s),s.name?(f(!0),d({...s,name:s.name})):(f(!1),d({name:""})),console.log("isEdit:",o),W(!0)},oe=()=>{console.log("formdetails in update",t);const s={name:t==null?void 0:t.name,email:t.email,role:t.role,mobileNumber:t.mobileNumber};console.log(s,"updateCategoryBody");const n=`${k.UPDATE_CATEGORY}/${t.publicId}`;U.patch(n,s,{headers:{"x-coreplatform-concurrencystamp":t.concurrencyStamp}}).then(r=>{r.status===204?window.location.reload():console.error("Unexpected response:",r)}).catch(r=>{r.response&&(r.response.status===417?console.error("Error 417:",r):r.response.status===500&&console.error("Error 500:",r))})},Y=()=>{W(!1)};return e.jsxs(pe,{children:[e.jsxs(xe,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(C,{variant:"h4",children:"Users"}),e.jsx("h6",{children:B&&e.jsx("div",{className:"success-message",children:B})}),e.jsx(_,{variant:"contained",color:"inherit",startIcon:e.jsx(v,{icon:"eva:plus-fill"}),onClick:L,children:"New User"})]}),e.jsxs(ge,{children:[e.jsx(J,{numSelected:u.length,filterName:y,onFilterName:re}),e.jsx(be,{children:e.jsx(ve,{sx:{overflow:"unset"},children:e.jsxs(Ce,{sx:{minWidth:800},children:[e.jsx(Q,{order:x,orderBy:S,rowCount:R.length,numSelected:u.length,onRequestSort:Z,onSelectAllClick:ee,headLabel:[{id:"Name",label:"Name"},{id:"Email",label:"Email"},{id:"Role",label:"Role"},{id:"Mobile Number",label:"Mobile Number"},{id:"status",label:"Status"},{id:"Edit",label:"Edit"},{id:""}]}),e.jsxs(Te,{children:[D.slice(a*h,a*h+h).map(s=>e.jsx(K,{domain:s.name,email:s.email,role:s.role,mobileNumber:s.mobileNumber,status:s.status,edit:e.jsx("img",{src:we,alt:"Edit",style:{cursor:"pointer"},onClick:()=>L(s)}),publicId:s.publicId,concurrencyStamp:s.concurrencyStamp,selected:u.indexOf(s.name)!==-1,handleClick:n=>se(n,s.name)},s.id)),e.jsx(V,{height:77,emptyRows:Re(a,h,R.length)}),ae&&e.jsx(z,{query:y})]})]})})}),e.jsx(Ne,{page:a,component:"div",count:R.length,rowsPerPage:h,onPageChange:te,rowsPerPageOptions:[10,20,50],onRowsPerPageChange:ne})]}),e.jsx(fe,{open:le,onClose:Y,sx:{width:"100vw"},children:e.jsxs(F,{width:"30vw",p:2,display:"flex",flexDirection:"column",gap:2,children:[e.jsxs(F,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(C,{variant:"h5",children:o?"Update User":"Add New User"}),e.jsx(Ee,{sx:{cursor:"pointer"},onClick:()=>{Y()}})]}),e.jsx(P,{variant:"outlined",placeholder:"Please Enter Your name",onChange:s=>{d(n=>({...n,name:s.target.value}))},value:t.name,fullWidth:!0,height:"20px",style:{border:w.name&&!t.name?"1px solid red":"none",borderRadius:"8px"}}),e.jsx(P,{variant:"outlined",placeholder:"Please Enter Your email",onChange:s=>{d(n=>({...n,email:s.target.value}))},value:t.email,fullWidth:!0,height:"20px",style:{border:w.email&&!t.email?"1px solid red":"none",borderRadius:"8px"}}),e.jsx(P,{variant:"outlined",placeholder:"Please Enter Your role",onChange:s=>{d(n=>({...n,role:s.target.value}))},value:t.role,fullWidth:!0,height:"20px",style:{border:w.role&&!t.role?"1px solid red":"none",borderRadius:"8px"}}),e.jsx(P,{variant:"outlined",placeholder:"Please Enter Your Mobile Number",onChange:s=>{d(n=>({...n,mobileNumber:s.target.value}))},value:t.mobileNumber,fullWidth:!0,height:"20px",style:{border:w.mobileNumber&&!t.mobileNumber?"1px solid red":"none",borderRadius:"8px"}}),e.jsx(_,{fullWidth:!0,variant:"contained",color:"primary",onClick:o?oe:X,children:o?"Update":"Add"})]})})]})}function Fe(){return e.jsxs(e.Fragment,{children:[e.jsx(je,{children:e.jsx("title",{children:" Users "})}),e.jsx(Ue,{})]})}export{Fe as default};
