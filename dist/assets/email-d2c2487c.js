import{j as e,K as r,F as G,r as c,I as M,C as T,a3 as je,N as J,a1 as v,a2 as E,a4 as be,T as R,a5 as ye,O as Se,a6 as V,w as Ce,Q as Ie,S as ve,R as X,E as Ee,a8 as Te,a9 as Re,W as Ae}from"./index-0fca6773.js";import{I as Pe}from"./InputField-0f02f94f.js";import{T as O,a as p,b as Ue,c as ke,d as Ne,e as Oe,u as N,f as qe,g as Fe,C as we}from"./user-bcbc9869.js";import{L as Z}from"./label-6990dc07.js";import{e as _e}from"./edit_icon-feef8411.js";function ee({emptyRows:a,height:l}){return a?e.jsx(O,{sx:{...l&&{height:l*a}},children:e.jsx(p,{colSpan:9})}):null}ee.propTypes={emptyRows:r.number,height:r.number};const Be={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function De(a,l,x){return a?Math.max(0,(1+a)*l-x):0}function se({order:a,orderBy:l,rowCount:x,headLabel:m,numSelected:o,onRequestSort:f,onSelectAllClick:C}){const b=i=>y=>{f(y,i)};return e.jsx(Ue,{children:e.jsx(O,{children:m.map(i=>e.jsx(p,{align:i.align||"left",sortDirection:l===i.id?a:!1,sx:{width:i.width,minWidth:i.minWidth},children:e.jsxs(ke,{hideSortIcon:!0,active:l===i.id,direction:l===i.id?a:"asc",onClick:b(i.id),children:[i.label,l===i.id?e.jsx(G,{sx:{...Be},children:a==="desc"?"sorted descending":"sorted ascending"}):null]})},i.id))})})}se.propTypes={order:r.oneOf(["asc","desc"]),orderBy:r.string,rowCount:r.number,headLabel:r.array,numSelected:r.number,onRequestSort:r.func,onSelectAllClick:r.func};function te({domain:a,email:l,role:x,mobileNumber:m,status:o,edit:f,publicId:C,concurrencyStamp:b,handleClick:i,selected:y,selectedPath:q}){const[A,j]=c.useState(null),F=u=>{j(u.currentTarget)},g=()=>{j(null)},P=u=>{console.log("check-status",C,b);const S={status:u};console.log(S,"statusUpdateBody");const U=`${E.STATUS_UPDATE_USER_CATEGORY}/${C}`;v.patch(U,S,{headers:{"x-coreplatform-concurrencyStamp":b}}).then(h=>{h.status===204?window.location.reload():console.error("Unexpected response:",h)}).catch(h=>{h.response&&(h.response.status===417?console.error("Error 417:",h):h.response.status===500&&console.error("Error 500:",h))})};return e.jsxs(e.Fragment,{children:[e.jsxs(O,{hover:!0,tabIndex:-1,role:"checkbox",selected:y,children:[e.jsx(p,{children:a}),e.jsx(p,{children:l}),e.jsx(p,{children:x}),e.jsx(p,{children:m}),e.jsx(p,{children:e.jsx(Z,{color:o==="banned"&&"error"||"success",children:o})}),e.jsx(p,{children:e.jsx(Z,{children:f})}),e.jsx(p,{align:"right",children:e.jsx(M,{onClick:F,children:e.jsx(T,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(je,{open:!!A,anchorEl:A,onClose:g,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsx(J,{onClick:()=>P("active"),children:"Active"}),e.jsx(J,{onClick:()=>P("inactive"),sx:{color:"error.main"},children:"Inactive"})]})]})}te.propTypes={domain:r.string.isRequired,email:r.string.isRequired,role:r.string.isRequired,mobileNumber:r.string.isRequired,status:r.string.isRequired,edit:r.string.isRequired,publicId:r.string.isRequired,concurrencyStamp:r.string.isRequired,handleClick:r.func,selected:r.bool,selectedPath:r.string.isRequired};function ne({numSelected:a,filterName:l,onFilterName:x}){return e.jsxs(be,{sx:{height:96,display:"flex",justifyContent:"space-between",p:m=>m.spacing(0,1,0,3),...a>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[a>0?e.jsxs(R,{component:"div",variant:"subtitle1",children:[a," selected"]}):e.jsx(ye,{value:l,onChange:x,placeholder:"Search user...",startAdornment:e.jsx(Se,{position:"start",children:e.jsx(T,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),a>0?e.jsx(V,{title:"Delete",children:e.jsx(M,{children:e.jsx(T,{icon:"eva:trash-2-fill"})})}):e.jsx(V,{title:"Filter list",children:e.jsx(M,{children:e.jsx(T,{icon:"ic:round-filter-list"})})})]})}ne.propTypes={numSelected:r.number,filterName:r.string,onFilterName:r.func};function ae({query:a}){return e.jsx(O,{children:e.jsx(p,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(Ce,{sx:{textAlign:"center"},children:[e.jsx(R,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(R,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',a,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}ae.propTypes={query:r.string};function Ge(){const[a,l]=c.useState(0),[x,m]=c.useState("asc"),[o,f]=c.useState([]),[C,b]=c.useState([]),[i,y]=c.useState(!1),[q,A]=c.useState("name"),[j,F]=c.useState(""),[g,P]=c.useState(5),[u,S]=c.useState({usersId:""}),[U,h]=c.useState({usersId:""}),[$,L]=c.useState(""),[H,w]=c.useState(""),[re,le]=c.useState([]),_=window.location.pathname.split("/"),B=_[1],I=_[_.length-1],k=B.charAt(0).toUpperCase()+B.slice(1);c.useEffect(()=>{(()=>{const n=`${E.GET_USERS}?pageSize=50`;v.get(n).then(t=>{le(t.data)}).catch(t=>{console.error(t)})})()},[a,g]),c.useEffect(()=>{(()=>{const n=`${E.GET_USER_CATEGORY}`;v.get(n).then(t=>{b(t.data)}).catch(t=>{console.error(t)})})()},[a,g,I]);const ie=()=>{const s={};if(u.usersId||(s.usersId="Please select a user."),Object.keys(s).length>0){h(s),L("");return}h({usersId:""});const n={categoryId:I,usersId:u.usersId,status:"active"};v.post(E.GET_USER_CATEGORY,n).then(t=>{t.status===201?(L("Service added successfully"),window.location.reload()):console.error("Unexpected response:",t)}).catch(t=>{t.response&&t.response.status===500&&w(t.response.data.details.message||"User Already Exists"),console.log("Error:",t)})},ce=(s,n)=>{n!==""&&(m(q===n&&x==="asc"?"desc":"asc"),A(n))},oe=s=>{if(s.target.checked){const n=N.map(t=>t.name);f(n);return}f([])},de=(s,n)=>{const t=o.indexOf(n);let d=[];t===-1?d=d.concat(o,n):t===0?d=d.concat(o.slice(1)):t===o.length-1?d=d.concat(o.slice(0,-1)):t>0&&(d=d.concat(o.slice(0,t),o.slice(t+1))),f(d)},ue=(s,n)=>{l(n)},he=s=>{l(0),P(parseInt(s.target.value,10))},pe=s=>{l(0),F(s.target.value)},D=C.filter(s=>{var n;return console.log(s,I,"item"),s.user&&s.user.name.toLowerCase().includes(j.toLowerCase())&&((n=s==null?void 0:s.category)==null?void 0:n.publicId)===I});console.log(D,"data filete fata");const xe=!D.length&&!!j,[ge,W]=c.useState(!1),Y=s=>{console.log("row in edit",s),s.usersId?(y(!0),S({...s,usersId:s.usersId})):(y(!1),S({usersId:""})),W(!0)},me=()=>{const s={categoryId:I,usersId:u.usersId};console.log("updateCategoryBody",s),console.log("concurrenct stamp in update",u);const n=`${E.GET_USER_CATEGORY}/${u.publicId}`;v.patch(n,s,{headers:{"x-coreplatform-concurrencystamp":u.concurrencyStamp}}).then(t=>{t.status===204?window.location.reload():console.error("Unexpected response:",t)}).catch(t=>{t.response&&(t.response.status===417||t.response.status===500)&&w(t.response.data.details.message||"User Already Exists")})},z=()=>{W(!1)};return e.jsxs(Ie,{children:[e.jsxs(ve,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(R,{variant:"h4",children:k}),e.jsx("h6",{children:$&&e.jsx("div",{className:"success-message",children:$})}),e.jsxs(X,{variant:"contained",color:"inherit",startIcon:e.jsx(T,{icon:"eva:plus-fill"}),onClick:Y,children:["New ",k]})]}),e.jsxs(Ee,{children:[e.jsx(ne,{numSelected:o.length,filterName:j,onFilterName:pe}),e.jsx(Te,{children:e.jsx(Ne,{sx:{overflow:"unset"},children:e.jsxs(Oe,{sx:{minWidth:800},children:[e.jsx(se,{order:x,orderBy:q,rowCount:N.length,numSelected:o.length,onRequestSort:ce,onSelectAllClick:oe,headLabel:[{id:"Name",label:"Name"},{id:"Email",label:"Email"},{id:"Role",label:"Role"},{id:"Mobile Number",label:"Mobile Number"},{id:"status",label:"Status"},{id:"Edit",label:"Edit"},{id:""}]}),e.jsxs(qe,{children:[D.slice(a*g,a*g+g).map(s=>{var n,t,d,K,Q;return e.jsx(te,{domain:(n=s==null?void 0:s.user)==null?void 0:n.name,email:(t=s==null?void 0:s.user)==null?void 0:t.email,role:(d=s==null?void 0:s.user)==null?void 0:d.role,mobileNumber:(K=s==null?void 0:s.user)==null?void 0:K.mobileNumber,status:s==null?void 0:s.status,edit:e.jsx("img",{src:_e,alt:"Edit",style:{cursor:"pointer"},onClick:()=>Y(s)}),publicId:s.publicId,concurrencyStamp:s.concurrencyStamp,selected:o.indexOf(s.name)!==-1,handleClick:fe=>de(fe,s.name),selectedPath:B},(Q=s==null?void 0:s.user)==null?void 0:Q.id)}),e.jsx(ee,{height:77,emptyRows:De(a,g,N.length)}),xe&&e.jsx(ae,{query:j})]})]})})}),e.jsx(Fe,{page:a,component:"div",count:N.length,rowsPerPage:g,onPageChange:ue,rowsPerPageOptions:[5,10,20,50,100],onRowsPerPageChange:he})]}),e.jsx(Re,{open:ge,onClose:z,sx:{width:"100vw"},children:e.jsxs(G,{width:"30vw",p:2,display:"flex",flexDirection:"column",gap:2,children:[e.jsxs(G,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(R,{variant:"h5",children:i?`Update ${k}`:`Add New ${k}`}),e.jsx(we,{sx:{cursor:"pointer"},onClick:z})]}),e.jsx("h6",{children:U.usersId&&e.jsx("span",{className:"error-message",children:U.usersId})}),e.jsx("h6",{children:H&&e.jsx("span",{className:"error-message",children:H})}),e.jsx(Pe,{label:"Users :",style:{width:"373px",padding:"8px"},onChange:s=>{S(n=>({...n,usersId:s.target.value}))},value:u.usersId,valueKey:"publicId",labelKey:"name",isRequired:!0,select:!0,options:re}),e.jsx(X,{fullWidth:!0,variant:"contained",color:"primary",onClick:i?me:ie,children:i?"Update":"Add"})]})})]})}function ze(){return e.jsxs(e.Fragment,{children:[e.jsx(Ae,{children:e.jsx("title",{children:" Email "})}),e.jsx(Ge,{})]})}export{ze as default};
