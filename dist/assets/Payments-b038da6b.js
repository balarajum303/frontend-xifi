import{j as e,w as ue,T as I,K as c,a4 as he,a5 as ge,O as pe,C as T,a6 as L,I as F,r as d,a3 as me,N as H,a1 as C,a2 as v,F as M,a7 as xe,Q as ye,S as fe,R as W,E as je,a8 as be,a9 as Se,M as Ce,W as ve}from"./index-0fca6773.js";import{T as k,a as f,b as Te,c as Ie,d as Pe,e as Ae,u as O,f as Ee,g as Ne,C as Oe}from"./user-bcbc9869.js";import{I as ke}from"./InputField-0f02f94f.js";import{L as z}from"./label-6990dc07.js";import{e as Re}from"./edit_icon-feef8411.js";function K({query:a}){return e.jsx(k,{children:e.jsx(f,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(ue,{sx:{textAlign:"center"},children:[e.jsx(I,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(I,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',a,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}K.propTypes={query:c.string};const we={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function Fe(a,l,p){return a?Math.max(0,(1+a)*l-p):0}function Q({numSelected:a,filterName:l,onFilterName:p}){return e.jsxs(he,{sx:{height:96,display:"flex",justifyContent:"space-between",p:m=>m.spacing(0,1,0,3),...a>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[a>0?e.jsxs(I,{component:"div",variant:"subtitle1",children:[a," selected"]}):e.jsx(ge,{value:l,onChange:p,placeholder:"Search user...",startAdornment:e.jsx(pe,{position:"start",children:e.jsx(T,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),a>0?e.jsx(L,{title:"Delete",children:e.jsx(F,{children:e.jsx(T,{icon:"eva:trash-2-fill"})})}):e.jsx(L,{title:"Filter list",children:e.jsx(F,{children:e.jsx(T,{icon:"ic:round-filter-list"})})})]})}Q.propTypes={numSelected:c.number,filterName:c.string,onFilterName:c.func};function V({selected:a,domain:l,amount:p,status:m,edit:u,publicId:x,concurrencyStamp:S}){const[j,r]=d.useState(null),b=y=>{r(y.currentTarget)},P=()=>{r(null)},A=y=>{console.log("check-ststua ",x,S);const E={status:y};console.log(E,"statusUpdateBody");const h=`${v.STATUS_UPDATE_PAYMENT_CATEGORY}/${x}`;C.patch(h,E,{headers:{"x-coreplatform-concurrencyStamp":S}}).then(g=>{g.status===204?window.location.reload():console.error("Unexpected response:",g)}).catch(g=>{g.response&&(g.response.status===417?console.error("Error 417:",g):g.response.status===500&&console.error("Error 500:",g))})};return e.jsxs(e.Fragment,{children:[e.jsxs(k,{hover:!0,tabIndex:-1,role:"checkbox",selected:a,children:[e.jsx(f,{children:l}),e.jsx(f,{children:p}),e.jsx(f,{children:e.jsx(z,{color:m==="banned"&&"error"||"success",children:m})}),e.jsx(f,{children:e.jsx(z,{children:u})}),e.jsx(f,{align:"right",children:e.jsx(F,{onClick:b,children:e.jsx(T,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(me,{open:!!j,anchorEl:j,onClose:P,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsx(H,{onClick:()=>A("active"),children:"Active"}),e.jsx(H,{onClick:()=>A("inactive"),sx:{color:"error.main"},children:"Inactive"})]})]})}V.propTypes={selected:c.bool,domain:c.string,amount:c.any,status:c.string,edit:c.any,publicId:c.string,concurrencyStamp:c.string};function J({order:a,orderBy:l,rowCount:p,headLabel:m,numSelected:u,onRequestSort:x,onSelectAllClick:S}){const j=r=>b=>{x(b,r)};return e.jsx(Te,{children:e.jsx(k,{children:m.map(r=>e.jsx(f,{align:r.align||"left",sortDirection:l===r.id?a:!1,sx:{width:r.width,minWidth:r.minWidth},children:e.jsxs(Ie,{hideSortIcon:!0,active:l===r.id,direction:l===r.id?a:"asc",onClick:j(r.id),children:[r.label,l===r.id?e.jsx(M,{sx:{...we},children:a==="desc"?"sorted descending":"sorted ascending"}):null]})},r.id))})})}J.propTypes={order:c.oneOf(["asc","desc"]),orderBy:c.string,rowCount:c.number,headLabel:c.array,numSelected:c.number,onRequestSort:c.func,onSelectAllClick:c.func};function X({emptyRows:a,height:l}){return a?e.jsx(k,{sx:{...l&&{height:l*a}},children:e.jsx(f,{colSpan:9})}):null}X.propTypes={emptyRows:c.number,height:c.number};function Me(){const[a,l]=d.useState(0),[p,m]=d.useState("asc"),[u,x]=d.useState([]),[S,j]=d.useState([]),[r,b]=d.useState(!1),[P,A]=d.useState("name"),[y,E]=d.useState(""),[h,g]=d.useState(5),[i,N]=d.useState({categoryId:"",amount:"",status:"active"}),[R,U]=d.useState({categoryId:"",amount:""}),[G,Y]=d.useState(""),[_,w]=d.useState(""),[Z,ee]=d.useState([]);d.useEffect(()=>{(()=>{const s=`${v.GET_CATEGORY}?pageSize=${h}&pageNumber=${a}`;C.get(s).then(n=>{console.log("get-all category",n),ee(n.data)}).catch(n=>{console.error(n)})})()},[a,h]),d.useEffect(()=>{(()=>{const s=`${v.GET_PAYMENT_CATEGORY}`;C.get(s).then(n=>{console.log("get-all payments",n),j(n.data)}).catch(n=>{console.error(n)})})()},[h,a]);const te=()=>{const t={};if(i.categoryId||(t.categoryId="Please Select Category."),i.amount?/^\d+$/.test(i.amount)||(t.amount="Amount must be a number."):t.amount="Amount is required.",Object.keys(t).length>0){U(t),Y("");return}U({categoryId:"",amount:""});const s=v.GET_PAYMENT_CATEGORY,n={categoryId:i.categoryId,amount:parseInt(i.amount,10),status:"active"};console.log("payment-post-body-",n),C.post(s,n).then(o=>{o?(Y("Payment added successfully"),window.location.reload()):console.error("Unexpected response:",o)}).catch(o=>{o.response&&o.response.status===500&&w(o.response.data.details.message||"Category Or Amount Already Exists"),console.log("Error:",o)})},se=(t,s)=>{s!==""&&(m(P===s&&p==="asc"?"desc":"asc"),A(s))},ne=t=>{if(t.target.checked){const s=O.map(n=>n.name);x(s);return}x([])},ae=(t,s)=>{const n=u.indexOf(s);let o=[];n===-1?o=o.concat(u,s):n===0?o=o.concat(u.slice(1)):n===u.length-1?o=o.concat(u.slice(0,-1)):n>0&&(o=o.concat(u.slice(0,n),u.slice(n+1))),x(o)},oe=(t,s)=>{l(s)},re=t=>{l(0),g(parseInt(t.target.value,10))},ce=t=>{l(0),E(t.target.value)},B=S.filter(t=>{var s;return(s=t==null?void 0:t.category)==null?void 0:s.categoryName.toLowerCase().includes(y.toLowerCase())}),le=!B.length&&!!y,[ie,$]=xe.useState(!1),D=t=>{var s;console.log("row",t),(s=t.category)!=null&&s.categoryName?(b(!0),N({...t,amount:t==null?void 0:t.amount,categoryId:t.category.publicId})):(b(!1),N({categoryId:"",amount:""})),console.log("isEdit:",r),$(!0)},de=()=>{var n;console.log("formdetails in update",i);const t={categoryId:(n=i==null?void 0:i.category)==null?void 0:n.publicId,amount:parseInt(i.amount,10)};console.log(t,"updateCategoryBody");const s=`${v.GET_PAYMENT_CATEGORY}/${i.publicId}`;C.patch(s,t,{headers:{"x-coreplatform-concurrencystamp":i.concurrencyStamp}}).then(o=>{o.status===204?window.location.reload():console.error("Unexpected response:",o)}).catch(o=>{o.response&&(o.response.status===417?w(o.response.data.details.message||"Category Already Exists"):o.response.status===500&&w(o.response.data.details.message||"Amount Or Category  Already Exists"))})},q=()=>{$(!1)};return e.jsxs(ye,{children:[e.jsxs(fe,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(I,{variant:"h4",children:"Payments"}),e.jsx("h6",{children:G&&e.jsx("div",{className:"success-message",children:G})}),e.jsx(W,{variant:"contained",color:"inherit",startIcon:e.jsx(T,{icon:"eva:plus-fill"}),onClick:D,children:"New Payment"})]}),e.jsxs(je,{children:[e.jsx(Q,{numSelected:u.length,filterName:y,onFilterName:ce}),e.jsx(be,{children:e.jsx(Pe,{sx:{overflow:"unset"},children:e.jsxs(Ae,{sx:{minWidth:800},children:[e.jsx(J,{order:p,orderBy:P,rowCount:O.length,numSelected:u.length,onRequestSort:se,onSelectAllClick:ne,headLabel:[{id:"Name",label:"Name"},{id:"Amount",label:"Amount"},{id:"status",label:"Status"},{id:"Edit",label:"Edit"},{id:""}]}),e.jsxs(Ee,{children:[B.slice(a*h,a*h+h).map(t=>{var s;return e.jsx(V,{domain:(s=t==null?void 0:t.category)==null?void 0:s.categoryName,amount:t==null?void 0:t.amount,status:t==null?void 0:t.status,edit:e.jsx("img",{src:Re,alt:"Edit",style:{cursor:"pointer"},onClick:()=>D(t)}),publicId:t.publicId,concurrencyStamp:t.concurrencyStamp,selected:u.indexOf(t.name)!==-1,handleClick:n=>ae(n,t.name)},t.id)}),e.jsx(X,{height:77,emptyRows:Fe(a,h,O.length)}),le&&e.jsx(K,{query:y})]})]})})}),e.jsx(Ne,{page:a,component:"div",count:O.length,rowsPerPage:h,onPageChange:oe,rowsPerPageOptions:[10,20,50],onRowsPerPageChange:re})]}),e.jsx(Se,{open:ie,onClose:q,sx:{width:"100vw"},children:e.jsxs(M,{width:"30vw",p:2,display:"flex",flexDirection:"column",gap:2,children:[e.jsxs(M,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(I,{variant:"h5",children:r?"Update Payment":"Add New Payment"}),e.jsx(Oe,{sx:{cursor:"pointer"},onClick:()=>{q()}})]}),e.jsx("h6",{children:R.categoryId&&e.jsx("span",{className:"error-message",children:R.categoryId})}),e.jsx("h6",{children:_&&e.jsx("span",{className:"error-message",children:_})}),e.jsx(ke,{label:"Categories :",style:{width:"373px",padding:"8px"},name:"categoryId",onChange:t=>{N(s=>({...s,categoryId:t.target.value}))},value:i.categoryId,valueKey:"publicId",labelKey:"categoryName",isRequired:!0,select:!0,options:Z}),e.jsx(Ce,{variant:"outlined",placeholder:"Please Enter Your amount",value:i==null?void 0:i.amount,onChange:t=>{N(s=>({...s,amount:t.target.value}))},fullWidth:!0,height:"20px",style:{border:R.amount&&!i.amount?"1px solid red":"none",borderRadius:"8px"}}),e.jsx(W,{fullWidth:!0,variant:"contained",color:"primary",onClick:r?de:te,children:r?"Update":"Add"})]})})]})}function $e(){return e.jsxs(e.Fragment,{children:[e.jsx(ve,{children:e.jsx("title",{children:" Payments "})}),e.jsx(Me,{})]})}export{$e as default};
